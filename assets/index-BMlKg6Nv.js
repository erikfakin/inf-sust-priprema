(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();function se(e){const t=[...e];for(let n=t.length-1;n>0;n--){const c=Math.floor(Math.random()*(n+1));[t[n],t[c]]=[t[c],t[n]]}return t}const ie={perfectScore:{id:"perfectScore",title:"RIP AND TEAR",description:"Slaughter all questions without mercy. Not a single survivor.",icon:"fas fa-skull",condition:e=>e.score===e.totalQuestions},speedDemon:{id:"speedDemon",title:"SPEED KILLS",description:"Finished with half the time remaining. Inf Sustavi demons couldn't even see you coming.",icon:"fas fa-bolt",condition:e=>e.timeUsedPercentage<50},consistentPerformer:{id:"consistentPerformer",title:"BRUTAL COMBO",description:"Annihilated 5 questions in a row. The info-demons cry in the corner.",icon:"fas fa-fire",condition:e=>e.maxStreak>=5},quickThinker:{id:"quickThinker",title:"ULTRA-VIOLENCE",description:"Executed a question in under 5 seconds. That was... messy.",icon:"fas fa-radiation",condition:e=>e.fastestAnswer<=5},comeback:{id:"comeback",title:"HELL WALKER",description:"Returned from the abyss after 2 wrong answers. Not even failure can stop you.",icon:"fas fa-skull-crossbones",condition:e=>e.hadComeback},halfwayHero:{id:"halfwayHero",title:"KNEE-DEEP IN THE DEAD",description:"Scored at least 50%. You've only just begun the carnage.",icon:"fas fa-bone",condition:e=>e.score>=e.totalQuestions/2},BFG:{id:"BFG",title:"BFG DIVISION",description:"Answered a difficult question correctly. Big. Freaking. Genius.",icon:"fas fa-meteor",condition:e=>R.some(t=>{const n=t.question.length>100,c=Array.isArray(t.correctAnswer)&&t.correctAnswer.length>1;return t.isCorrect&&(n||c)})},marathonComplete:{id:"marathonComplete",title:"ULTRA NIGHTMARE",description:"Completed the MARATHON MODE. You've proven you can survive the onslaught of information systems!",icon:"fas fa-fire",condition:e=>e.marathonMode&&e.score>e.totalQuestions*.6}};let y=[],M={},de=[],p=0,I=0,b=1200,D=1200,R=[],G=0,U=0,z=0,Z=!1,ue=0,Q=1/0,o={questionCount:15,timerSetting:1200,soundEffects:!0,backgroundMusic:!0,musicVolume:20,marathonMode:!1},me,w=[];const K=document.getElementById("welcome-screen"),Te=document.getElementById("start-btn"),x=document.getElementById("question-count"),S=document.getElementById("timer-setting"),T=document.getElementById("sound-toggle"),ee=document.getElementById("marathon-mode"),Be=document.getElementById("view-high-scores"),fe=document.getElementById("quiz-container"),Ne=document.getElementById("question"),q=document.getElementById("answer-buttons"),B=document.getElementById("next-btn"),V=document.getElementById("time-display"),A=document.getElementById("timer-bar"),he=document.getElementById("score"),qe=document.getElementById("progress-bar"),ge=document.getElementById("current-question"),W=document.getElementById("total-questions"),$e=document.getElementById("question-number"),Oe=document.getElementById("category-badge"),Y=document.getElementById("feedback-container"),De=document.getElementById("feedback-text"),P=document.getElementById("correct-answer"),F=document.getElementById("results-screen"),ce=document.getElementById("final-score"),He=document.getElementById("time-taken"),Re=document.getElementById("accuracy"),$=document.getElementById("achievements-list"),Pe=document.getElementById("view-answers-btn"),Ge=document.getElementById("save-score-btn"),ze=document.getElementById("restart-button"),pe=document.getElementById("review-screen"),ae=document.getElementById("summary"),Ve=document.getElementById("back-to-results"),ye=document.getElementById("high-scores-screen"),j=document.getElementById("high-scores-list"),Ue=document.getElementById("back-btn"),Qe=document.getElementById("clear-scores-btn"),J=document.getElementById("correct-sound"),X=document.getElementById("wrong-sound"),f=document.getElementById("click-sound"),_=document.getElementById("complete-sound"),m=document.getElementById("background-music"),L=document.getElementById("sound-toggle-btn"),v=document.getElementById("music-volume-slider");function Ye(){Fe(),ct(),fetch("questions.json").then(e=>e.json()).then(e=>{de=e,je(e),Ke(),Je()}).catch(e=>console.error("Error loading questions:",e))}function Fe(){J.volume=.6,X.volume=.6,f.volume=.5,_.volume=.7;const e=o.musicVolume/100;m.volume=e,v&&(v.value=o.musicVolume,H(o.musicVolume)),o.backgroundMusic=!0,Ee();const t=[J,X,f,_,m];t.forEach(n=>{n.preload="auto",n.load(),n.addEventListener("canplaythrough",()=>{console.log(`${n.id} loaded successfully`)}),n.addEventListener("error",c=>{console.warn(`Error loading audio ${n.id}, but will continue:`,c)})}),document.addEventListener("click",()=>{if(o.soundEffects){const n=()=>{t.forEach(c=>{c.play().then(()=>{c.pause(),c.currentTime=0}).catch(i=>{console.log(`Audio unlock attempted for ${c.id}:`,i)})}),document.removeEventListener("click",n)};n()}},{once:!0})}function Ee(){if(o.backgroundMusic)try{m.currentTime=0,m.loop=!0,m.volume=o.musicVolume/100;const e=m.play();e!==void 0&&e.then(()=>{console.log("Background music started successfully")}).catch(t=>{console.log("Background music autoplay prevented:",t)})}catch(e){console.error("Error playing background music:",e)}}function je(e){M={"General Knowledge":[],"Computer Science":[],Business:[],Other:[]},e.forEach(t=>{const n=t.text.toLowerCase();n.includes("computer")||n.includes("software")||n.includes("hardware")||n.includes("sistem")?M["Computer Science"].push(t):n.includes("business")||n.includes("organization")||n.includes("management")||n.includes("poduzeće")||n.includes("sustav")?M.Business.push(t):n.includes("knowledge")||n.includes("information")||n.includes("informacij")?M["General Knowledge"].push(t):M.Other.push(t)})}function Ke(){Te.addEventListener("click",()=>{h(f),We(),o.backgroundMusic=!0,m.currentTime=0,m.loop=!0,m.volume=o.musicVolume/100;const e=()=>{m.play().then(()=>{console.log("Background music started successfully on button click")}).catch(t=>{console.log("Retrying music playback after error:",t),setTimeout(e,100)})};e(),C(fe),Xe()}),Be.addEventListener("click",()=>{h(f),te()}),B.addEventListener("click",()=>{h(f),Ie()}),Pe.addEventListener("click",()=>{h(f),C(pe),tt()}),Ge.addEventListener("click",()=>{h(f),ot()}),ze.addEventListener("click",()=>{h(f),st(),C(K)}),Ve.addEventListener("click",()=>{h(f),C(F)}),Ue.addEventListener("click",()=>{h(f),C(K)}),Qe.addEventListener("click",()=>{h(f),nt()}),T.addEventListener("change",()=>{o.soundEffects=T.checked,localStorage.setItem("quizGameSettings",JSON.stringify(o)),O()}),L.addEventListener("click",()=>{o.soundEffects=!o.soundEffects,T.checked=o.soundEffects,localStorage.setItem("quizGameSettings",JSON.stringify(o)),O(),o.soundEffects&&h(f)}),v.addEventListener("input",()=>{const e=v.value;le(e),H(e),m.paused&&o.backgroundMusic&&m.play().catch(t=>{console.log("Tried to play music when slider moved:",t)}),o.soundEffects&&h(f)}),ee.addEventListener("change",function(){if(this.checked){x.disabled=!0,x.classList.add("disabled"),S.disabled=!0,S.classList.add("disabled");const e=document.querySelector('label[for="timer-setting"]');e&&(e.innerHTML='Time limit: <span class="unlimited-label">UNLIMITED</span>'),o.marathonMode=!0,localStorage.setItem("quizGameSettings",JSON.stringify(o)),o.soundEffects&&h(f)}else{x.disabled=!1,x.classList.remove("disabled"),S.disabled=!1,S.classList.remove("disabled");const e=document.querySelector('label[for="timer-setting"]');e&&(e.textContent="Time limit:"),o.marathonMode=!1,localStorage.setItem("quizGameSettings",JSON.stringify(o)),o.soundEffects&&h(f)}}),L.addEventListener("click",()=>{o.soundEffects=!o.soundEffects,T.checked=o.soundEffects,localStorage.setItem("quizGameSettings",JSON.stringify(o)),O(),o.soundEffects&&h(f)}),v.addEventListener("input",()=>{const e=v.value;le(e),H(e),m.paused&&o.backgroundMusic&&m.play().catch(t=>{console.log("Tried to play music when slider moved:",t)}),o.soundEffects&&h(f)})}function We(){o.questionCount=parseInt(x.value),o.timerSetting=parseInt(S.value),o.soundEffects=T.checked,o.backgroundMusic=!0,o.marathonMode=ee.checked,localStorage.setItem("quizGameSettings",JSON.stringify(o))}function Je(){const e=localStorage.getItem("quizGameSettings");if(e){if(o=JSON.parse(e),o.musicVolume===void 0&&(o.musicVolume=20),o.marathonMode===void 0&&(o.marathonMode=!1),o.backgroundMusic=!0,x.value=o.questionCount,S.value=o.timerSetting,ee.checked=o.marathonMode,T.checked=o.soundEffects,o.marathonMode){x.disabled=!0,x.classList.add("disabled"),S.disabled=!0,S.classList.add("disabled");const t=document.querySelector('label[for="timer-setting"]');t&&(t.innerHTML='Time limit: <span class="unlimited-label">UNLIMITED</span>')}v.value=o.musicVolume,H(o.musicVolume),O()}else O(),H(o.musicVolume)}function O(){o.soundEffects?(L.classList.add("active"),L.classList.remove("muted"),L.innerHTML='<i class="fas fa-volume-up"></i>'):(L.classList.remove("active"),L.classList.add("muted"),L.innerHTML='<i class="fas fa-volume-mute"></i>'),o.backgroundMusic=!0,v.value=o.musicVolume,document.getElementById("volume-value-display")&&(document.getElementById("volume-value-display").textContent=`${o.musicVolume}%`),v.style.background=`linear-gradient(to right, var(--doom-red) 0%, var(--doom-red) ${o.musicVolume}%, #444 ${o.musicVolume}%, #444 100%)`}function C(e){K.classList.remove("active"),fe.classList.remove("active"),F.classList.remove("active"),pe.classList.remove("active"),ye.classList.remove("active"),e.classList.add("active"),e===F&&o.soundEffects&&_.play()}function Xe(){p=0,I=0,R=[],G=0,U=0,z=0,Z=!1,Q=1/0,o.backgroundMusic&&Ee(),b=o.timerSetting,D=b,he.textContent="0",_e(),ge.textContent="1",o.marathonMode?(V.innerHTML='<span class="infinity-symbol">∞</span> UNLIMITED',V.classList.add("unlimited-time"),W.textContent=y.length):(Le(),W.textContent=o.questionCount,V.classList.remove("unlimited-time")),be(),o.marathonMode||Ze(),ve()}function _e(){y=[];const e=[...de].sort(()=>Math.random()-.5);o.marathonMode?(y=e,W.textContent=y.length):y=e.slice(0,o.questionCount)}function ve(){clearTimeout(me);const e=y[p];Ne.textContent=e.text,$e.textContent=`Question ${p+1}`;let t="General Knowledge";for(const[n,c]of Object.entries(M))if(c.some(i=>i.text===e.text)){t=n;break}if(Oe.textContent=t,q.innerHTML="",Y.style.display="none",ue=Date.now(),e.type==="matching"){const n=document.createElement("div");n.className="matching-container";const c=document.createElement("div");c.className="matching-column left-column";const i=document.createElement("div");i.className="matching-column right-column",e.leftItems.forEach(l=>{const s=document.createElement("div");s.className="matching-item left-item",s.dataset.id=l.id;const d=document.createElement("div");d.className="matching-item-content",d.textContent=l.text,s.appendChild(d);const u=document.createElement("div");u.className="matching-drop-zone",u.dataset.leftId=l.id,u.innerHTML='<span class="drop-placeholder">Drop answer here</span>',u.addEventListener("dragover",g=>{g.preventDefault(),u.classList.add("drag-over")}),u.addEventListener("dragleave",()=>{u.classList.remove("drag-over")}),u.addEventListener("drop",g=>{g.preventDefault(),u.classList.remove("drag-over");const E=g.dataTransfer.getData("text/plain"),N=document.querySelector(`.right-item[data-id="${E}"]`),k=u.querySelector(".right-item");k&&(i.appendChild(k),k.classList.remove("matched")),N&&(u.querySelector(".drop-placeholder").style.display="none",u.appendChild(N),N.classList.add("matched"))}),s.appendChild(u),c.appendChild(s)}),se([...e.rightItems]).forEach(l=>{const s=document.createElement("div");s.className="matching-item right-item",s.dataset.id=l.id,s.textContent=l.text,s.draggable=!0,s.addEventListener("dragstart",d=>{d.dataTransfer.setData("text/plain",l.id),s.classList.add("dragging");const u=s.closest(".matching-drop-zone");u&&(u.querySelector(".drop-placeholder").style.display="block")}),s.addEventListener("dragend",()=>{s.classList.remove("dragging")}),i.appendChild(s)}),n.appendChild(c),n.appendChild(i),q.appendChild(n);const r=document.createElement("p");r.className="matching-help",r.innerHTML="Drag the items from the right column and drop them onto the matching items on the left.",q.appendChild(r)}else if(e.type==="fill-in-the-blank"){const n=document.createElement("div");n.className="doom-input-container fill-blank-container";const c=document.createElement("i");c.className="fas fa-pen-nib input-icon",n.appendChild(c);const i=document.createElement("input");i.type="text",i.id="user-answer",i.placeholder="TYPE YOUR ANSWER HERE, SLAYER...",i.setAttribute("autocomplete","off"),i.setAttribute("autocorrect","off"),i.setAttribute("autocapitalize","off"),i.setAttribute("spellcheck","false"),n.appendChild(i),q.appendChild(n),i.focus(),i.addEventListener("keypress",function(a){a.key==="Enter"&&!B.disabled&&Ie()})}else{const n=e.answers.filter(r=>r.correct).length>1,c=e.answers.map((r,l)=>({...r,originalIndex:l})),i=e.answers.length===2&&(e.answers.some(r=>r.text==="Točno")&&e.answers.some(r=>r.text==="Netočno")||e.answers.some(r=>r.text==="True")&&e.answers.some(r=>r.text==="False"));let a;i?a=c:a=se(c),a.forEach((r,l)=>{const s=document.createElement("div");s.className="answer-option",s.dataset.index=r.originalIndex;const d=document.createElement("input");d.type=n?"checkbox":"radio",d.name="answer",d.id=`answer-${l}`,d.value=r.text;const u=document.createElement("label");u.htmlFor=`answer-${l}`,u.textContent=r.text,s.appendChild(d),s.appendChild(u),s.addEventListener("click",function(g){g.target!==d&&(d.type==="radio"?(document.querySelectorAll("#answer-buttons .answer-option").forEach(E=>{E.classList.remove("selected")}),s.classList.add("selected"),d.checked=!0):(d.checked=!d.checked,s.classList.toggle("selected",d.checked)))}),u.addEventListener("click",function(g){g.preventDefault(),g.stopPropagation(),d.type==="radio"?(document.querySelectorAll("#answer-buttons .answer-option").forEach(E=>{E.classList.remove("selected")}),s.classList.add("selected"),d.checked=!0):(d.checked=!d.checked,s.classList.toggle("selected",d.checked))}),q.appendChild(s)})}B.disabled=!1,B.textContent="Attack!",B.innerHTML='Attack! <i class="fas fa-khanda"></i>'}function Ie(){const e=y[p];if(Y.style.display==="none"){let t,n=!1;if(e.type==="matching"){const a=document.querySelectorAll(".matching-drop-zone"),r=[];a.forEach(l=>{const s=l.querySelector(".right-item");s&&r.push({leftId:l.dataset.leftId,rightId:s.dataset.id})}),t=r.map(l=>{const s=e.leftItems.find(u=>u.id===l.leftId),d=e.rightItems.find(u=>u.id===l.rightId);return`${s.text} → ${d.text}`}),n=r.length===e.correctPairs.length&&r.every(l=>e.correctPairs.some(s=>s.leftId===l.leftId&&s.rightId===l.rightId)),a.forEach(l=>{const s=l.dataset.leftId,d=l.querySelector(".right-item");if(d){const u=d.dataset.id;e.correctPairs.some(E=>E.leftId===s&&E.rightId===u)?(l.classList.add("matching-correct"),d.classList.add("matching-correct")):(l.classList.add("matching-incorrect"),d.classList.add("matching-incorrect"))}else l.classList.add("matching-incomplete")})}else if(e.type==="fill-in-the-blank")t=document.getElementById("user-answer").value.trim(),Array.isArray(e.correctAnswer)?n=e.correctAnswer.map(a=>a.toLowerCase()).includes(t.toLowerCase()):n=t.toLowerCase()===e.correctAnswer.toLowerCase();else{const a=document.querySelectorAll("#answer-buttons .answer-option.selected");t=Array.from(a).map(s=>{const d=parseInt(s.dataset.index);return e.answers[d].text}),console.log("Selected answers:",t);const r=e.answers.filter(s=>s.correct).map(s=>s.text);console.log("Correct answers:",r),n=t.length===r.length&&t.every(s=>r.includes(s))&&r.every(s=>t.includes(s)),document.querySelectorAll("#answer-buttons .answer-option").forEach(s=>{const d=parseInt(s.dataset.index),u=s.classList.contains("selected"),g=e.answers[d].correct;g?s.classList.add("correct"):u&&!g&&s.classList.add("incorrect")})}const c=(Date.now()-ue)/1e3;Q=Math.min(Q,c),R.push({question:e.text,userAnswer:t,correctAnswer:e.type==="matching"?e.correctPairs.map(a=>{const r=e.leftItems.find(s=>s.id===a.leftId),l=e.rightItems.find(s=>s.id===a.rightId);return`${r.text} → ${l.text}`}):e.type==="fill-in-the-blank"?e.correctAnswer:e.answers.filter(a=>a.correct).map(a=>a.text),isCorrect:n,timeTaken:c}),n?(G++,U=Math.max(U,G),z>=2&&(Z=!0),z=0,h(J),I++,he.textContent=I,re(!0)):(G=0,z++,h(X),re(!1));const i=o.marathonMode?p>=y.length-1:p>=Math.min(y.length-1,o.questionCount-1);B.innerHTML=i?'Complete Quest <i class="fas fa-flag-checkered"></i>':'Next Challenge <i class="fas fa-arrow-right"></i>';return}p++,o.marathonMode&&p<y.length||!o.marathonMode&&p<y.length&&p<o.questionCount?(be(),ge.textContent=p+1,ve()):we()}function re(e){const t=y[p];if(Y.style.display="block",Y.className=e?"correct":"incorrect",De.textContent=e?"DEMON SLAYED!":"TARGET SURVIVED!",e&&(P.textContent="",document.getElementById("explanation-text").textContent=t.explanation||""),t.type==="matching"){if(!e){const n=t.correctPairs.map(c=>{const i=t.leftItems.find(r=>r.id===c.leftId),a=t.rightItems.find(r=>r.id===c.rightId);return`${i.text} → ${a.text}`}).join("; ");P.textContent=`CORRECT MATCHES: ${n}`,document.getElementById("explanation-text").style.display="block",document.getElementById("explanation-text").textContent=t.explanation||""}}else if(t.type==="fill-in-the-blank"){const n=document.querySelectorAll("#answer-buttons .answer-option.selected");if(Array.from(n).map(c=>{const i=parseInt(c.dataset.index);return t.answers[i].text}),!e){const c=t.type==="fill-in-the-blank"?t.correctAnswer:t.answers.filter(a=>a.correct).map(a=>a.text),i=Array.isArray(c)?c.join(", "):c;P.textContent=`PROPER WEAPON: ${i}`,document.getElementById("explanation-text").style.display="block",document.getElementById("explanation-text").textContent=t.explanation||""}}else{const n=document.querySelectorAll("#answer-buttons .answer-option.selected");if(Array.from(n).map(c=>{const i=parseInt(c.dataset.index);return t.answers[i].text}),!e){const c=t.answers.filter(a=>a.correct).map(a=>a.text),i=Array.isArray(c)?c.join(", "):c;P.textContent=`PROPER WEAPON: ${i}`,document.getElementById("explanation-text").style.display="block",document.getElementById("explanation-text").textContent=t.explanation||""}}}function be(){const e=o.marathonMode?y.length:o.questionCount,t=p/e*100;qe.style.width=`${t}%`}function Ze(){if(w.forEach(clearInterval),w=[],!o.marathonMode){const n=setInterval(()=>{b>0?(b--,Le()):(clearInterval(n),we())},1e3);w.push(n)}A.style.transition="width 1s linear",A.style.width="100%";function e(){const n=b/D*100;A.style.width=`${n}%`,n>50?A.style.backgroundColor="var(--primary-color)":n>25?A.style.backgroundColor="var(--warning-color)":A.style.backgroundColor="var(--error-color)"}const t=setInterval(e,1e3);w.push(t)}function Le(){const e=Math.floor(b/60),t=b%60;V.textContent=`${e}:${t<10?"0":""}${t}`}function we(){w.forEach(clearInterval),w=[];const e=o.marathonMode?y.length:o.questionCount,t=I/e*100;let n=0,c=0,i="";if(o.marathonMode)i="UNLIMITED";else{n=D-b,c=n/D*100;const l=Math.floor(n/60),s=n%60;i=`${l}:${s<10?"0":""}${s}`}ce.textContent=`${I}/${e}`,He.textContent=i,Re.textContent=`${Math.round(t)}%`,o.marathonMode&&(ce.innerHTML+=' <span class="marathon-badge"><i class="fas fa-fire"></i> MARATHON</span>');const a={score:I,totalQuestions:e,accuracy:t,timeUsed:n,timeUsedPercentage:c,maxStreak:U,marathonMode:o.marathonMode,fastestAnswer:Q,hadComeback:Z};et(a),t>=70&&setTimeout(()=>{it()},300);const r=`Player_${new Date().toLocaleDateString().replace(/\//g,"-")}_${new Date().toLocaleTimeString().replace(/:/g,"-")}`;Se(r),C(F)}function et(e){$.innerHTML="";const t=document.createElement("div");t.className="achievement-header",t.innerHTML="DEMONIC ACHIEVEMENTS UNLOCKED",$.appendChild(t);let n=!1,c=0;const i=[];for(const a of Object.values(ie))a.condition(e)&&(i.push(a),n=!0,c++);if(n){const a=document.createElement("div");a.className="achievement-counter",a.innerHTML=`${c}/${Object.keys(ie).length} GLORY KILLS`,$.appendChild(a),i.forEach((r,l)=>{const s=document.createElement("div");s.className="achievement doom-achievement",s.style.animationDelay=`${l*.2}s`,s.style.opacity="0",s.style.transform="translateX(-100px)",s.innerHTML=`
        <div class="achievement-icon"><i class="${r.icon}"></i></div>
        <div class="achievement-info">
          <div class="achievement-title">${r.title}</div>
          <div class="achievement-desc">${r.description}</div>
        </div>
      `,$.appendChild(s),s.offsetHeight})}else{const a=document.createElement("div");a.className="no-achievements doom-failure",a.innerHTML='MORTALLY CHALLENGED<br><span class="doom-subtitle">YOUR WEAKNESS IS SHOWING. RIP HARDER NEXT TIME.</span>',a.style.opacity="0",$.appendChild(a),a.offsetHeight,a.style.opacity="1"}}function tt(){ae.innerHTML="",R.forEach((e,t)=>{const n=document.createElement("div");n.className=e.isCorrect?"correct":"incorrect";let c,i;e.question.includes("Upari pojmove")||e.question.includes("matching")?(c=Array.isArray(e.userAnswer)?e.userAnswer.join("<br>"):e.userAnswer,i=Array.isArray(e.correctAnswer)?e.correctAnswer.join("<br>"):e.correctAnswer):(c=Array.isArray(e.userAnswer)?e.userAnswer.join(", "):e.userAnswer,i=Array.isArray(e.correctAnswer)?e.correctAnswer.join(", "):e.correctAnswer),n.innerHTML=`
      <p><strong>BATTLE ${t+1}:</strong> ${e.question}</p>
      <p><strong>YOUR ATTACK:</strong> <span class="${e.isCorrect?"correct":"incorrect"}">${c||"(No attack)"}</span></p>
      <p><strong>KILLING BLOW:</strong> <span class="correct">${i}</span></p>
      <p><strong>EXECUTION TIME:</strong> ${e.timeTaken.toFixed(1)} seconds</p>
    `,ae.appendChild(n)})}function te(){const e=xe();if(j.innerHTML="",e.length===0){const t=document.createElement("div");t.className="no-scores-message",t.textContent="THE SLAYER'S HALL AWAITS ITS FIRST DOOM SLAYER. WILL YOU CLAIM BLOODY GLORY?",j.appendChild(t)}else e.sort((t,n)=>n.score!==t.score?n.score-t.score:t.time-n.time),e.slice(0,10).forEach((t,n)=>{const c=document.createElement("div");c.className="high-score-item",c.innerHTML=`
        <div class="high-score-rank">#${n+1}</div>
        <div class="high-score-info">
          <div class="high-score-name">${t.name}</div>
          <div class="high-score-date">${new Date(t.date).toLocaleDateString()}</div>
        </div>
        <div class="high-score-value">${t.score}/${t.totalQuestions}</div>
      `,j.appendChild(c)});C(ye)}function xe(){const e=localStorage.getItem("quizHighScores");return e?JSON.parse(e):[]}function Se(e){let t=xe();const n=D-b,c=Date.now(),i=t[t.length-1],a=i&&i.score===I&&i.totalQuestions===o.questionCount&&i.time===n&&c-i.date<3e5,r={name:e,score:I,totalQuestions:o.questionCount,time:n,date:c};a?t[t.length-1].name=e:t.push(r),localStorage.setItem("quizHighScores",JSON.stringify(t)),te()}function nt(){localStorage.removeItem("quizHighScores"),te()}function ot(){const e=document.createElement("div");e.id="save-score-modal",e.style.display="flex",e.innerHTML=`
    <div class="modal-content">
      <h2 class="modal-title">Claim Your Legend</h2>
      <p>Your feat has been recorded in the annals. Enter your warrior name for the Hall of Fame.</p>
      <div class="doom-input-container">
        <i class="fas fa-skull input-icon"></i>
        <input type="text" id="player-name" class="modal-input" placeholder="ENTER YOUR NAME, SLAYER..." maxlength="20" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
      </div>
      <div class="modal-buttons">
        <button id="cancel-save" class="btn secondary-btn"><i class="fas fa-times"></i> Retreat</button>
        <button id="confirm-save" class="btn primary-btn"><i class="fas fa-trophy"></i> Claim Glory</button>
      </div>
    </div>
  `,document.body.appendChild(e),document.getElementById("player-name").focus(),document.getElementById("confirm-save").addEventListener("click",()=>{const t=document.getElementById("player-name").value.trim();t&&Se(t),document.body.removeChild(e)}),document.getElementById("cancel-save").addEventListener("click",()=>{document.body.removeChild(e)}),e.addEventListener("click",t=>{t.target===e&&document.body.removeChild(e)})}function st(){p=0,I=0,R=[],clearTimeout(me),w.forEach(clearInterval),w=[]}function it(){console.log("Showing confetti");const e=document.getElementById("confetti-styles");e&&document.head.removeChild(e);const t=document.createElement("style");t.id="confetti-styles",t.textContent=`
    .confetti-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      pointer-events: none;
      z-index: 100;
    }
    
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #f00;
      pointer-events: none;
      z-index: 100;
      animation: confettiAnimation 3s ease-in forwards;
      transform-origin: center;
      will-change: transform, opacity;
      top: 50%;
      left: 50%;
    }
    
    @keyframes confettiAnimation {
      0% {
        transform: translate(-50%, -50%) scale(0.1) rotate(0deg);
        opacity: 1;
      }
      25% {
        opacity: 1;
      }
      100% {
        transform: translate(calc(-50% + var(--tx) * 1px), calc(-50% + var(--ty) * 1px)) scale(1) rotate(var(--rot));
        opacity: 0;
      }
    }
    
    .confetti-circle {
      border-radius: 50%;
    }
    
    .confetti-rect {
      width: 12px;
      height: 6px;
    }
    
    .confetti-triangle {
      width: 0 !important;
      height: 0 !important;
      background-color: transparent !important;
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
      border-bottom: 12px solid;
    }
  `,document.head.appendChild(t);const n=document.getElementById("confetti-container");n.innerHTML="",n.className="confetti-container";const c=n.getBoundingClientRect(),i=c.width,a=c.height,r=["#f72585","#4361ee","#4cc9f0","#4895ef","#3a0ca3","#ffbe0b","#fb5607"];for(let l=0;l<150;l++){const s=document.createElement("div"),d=["circle","rect","triangle"],u=d[Math.floor(Math.random()*d.length)];s.classList.add("confetti",`confetti-${u}`);const g=Math.random()*8+5;s.style.width=`${g}px`,s.style.height=`${g}px`;const E=r[Math.floor(Math.random()*r.length)];u==="triangle"?s.style.borderBottomColor=E:s.style.backgroundColor=E;const N=Math.min(i,a)*.45,k=Math.random()*Math.PI*2,ne=Math.random()*N,ke=Math.cos(k)*ne,Ae=Math.sin(k)*ne,Me=Math.random()*720-360;s.style.setProperty("--tx",ke),s.style.setProperty("--ty",Ae),s.style.setProperty("--rot",`${Me}deg`);const oe=Math.random()*2+2;s.style.animationDuration=`${oe}s`,n.appendChild(s),setTimeout(()=>{n.contains(s)&&n.removeChild(s)},oe*1e3+100)}}function ct(){const e=()=>{o.backgroundMusic&&m.paused&&m.play().then(()=>{document.removeEventListener("click",e),document.removeEventListener("touchstart",e),document.removeEventListener("keydown",e),document.removeEventListener("mousemove",e),m.paused=!1}).catch(t=>{console.log("Still can't autoplay music:",t)})};document.addEventListener("click",e),document.addEventListener("touchstart",e),document.addEventListener("keydown",e),document.addEventListener("mousemove",e)}function h(e){if(o.soundEffects)try{e.currentTime=0;const t=e.play();t!==void 0&&t.catch(n=>{console.log("Audio playback failed, but will not use synthetic fallback: ",n)})}catch(t){console.error("Audio playback error:",t)}}const Ce=document.createElement("style");Ce.innerHTML=`
  @keyframes confetti-explosion {
    0% {
      transform: translate(-50%, -50%) scale(0.1) rotate(0deg);
      opacity: 1;
    }
    25% {
      opacity: 1;
    }
    100% {
      transform: translate(var(--x-end), var(--y-end)) scale(1) rotate(720deg);
      opacity: 0;
    }
  }
  
  .confetti {
    position: absolute;
    z-index: 100;
    transform: translate(-50%, -50%);
    animation-name: confetti-explosion;
    animation-duration: 2s;
    animation-fill-mode: forwards;
    animation-timing-function: cubic-bezier(0.17, 0.67, 0.83, 0.67);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  .confetti.circle {
    border-radius: 50%;
  }
  
  .confetti.square {
    border-radius: 0;
  }
  
  .confetti.triangle {
    width: 0 !important;
    height: 0 !important;
    background-color: transparent !important;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-bottom: 14px solid; /* Will inherit the backgroundColor as border color */
  }
  
  .confetti.rectangle {
    border-radius: 2px;
    transform-origin: center;
  }
`;document.head.appendChild(Ce);function le(e){const t=e/100;o.musicVolume=parseInt(e),m.volume=t,localStorage.setItem("quizGameSettings",JSON.stringify(o))}function H(e){v.style.background=`linear-gradient(to right, var(--doom-red) 0%, var(--doom-red) ${e}%, #444 ${e}%, #444 100%)`;const t=document.getElementById("volume-value-display");t&&(t.textContent=`${e}%`)}Ye();
